# Docker Install Guide (VM)

## Summary
- **Goal:** Install Docker Engine and the Compose plugin on the VM using the pinned versions.
- **Scope:** VM-side steps only; uses repo pins in `Apps/n8n-app/ops/system-packages.txt`.

## Preconditions
- VM is **Ubuntu 22.04 LTS (primary)** or **Debian 12 (supported)** and has sudo access.
- Repo is present on the VM (same structure as this repo).
- `Apps/n8n-app/ops/system-packages.txt` has pinned Docker package versions.

## Variables
| **Name** | **Example** | **Notes** |
| --- | --- | --- |
| `PRIMARY_OS` | `Ubuntu 22.04` | Primary target per design docs. |
| `SUPPORTED_OS` | `Ubuntu 22.04`, `Debian 12` | Supported OS list per design docs. |
| `DOCKER_KEYRING_PATH` | `/etc/apt/keyrings/docker.gpg` | Path used by Docker official repo. |

## Install Steps (VM)
1) SSH to the VM.
2) Clone the repo if you haven't already:
```bash
git clone https://github.com/DoctorDatah/self-hosted-server-apps ~/self-hosted-server-apps
```
3) Run the VM install script from the repo root:
```bash
~/self-hosted-server-apps/Apps/n8n-app/n8n-vm/1.\ docker\ install.sh
```
4) Verify installation:
```bash
docker --version
docker compose version
```

## Notes
- These steps assume the repo is cloned on the VM.
- Host packages should stay minimal; app/runtime dependencies ship as containers only.

## Troubleshooting
- **Package not found:** Confirm pinned versions in `Apps/n8n-app/ops/system-packages.txt` match your OS (`ubuntu.22.04` for Ubuntu 22.04 or `debian.12` for Debian 12).
- **Keyring errors:** Ensure `/etc/apt/keyrings` exists and is readable.
- **Permission denied:** Add your user to the `docker` group or use sudo for docker commands.

## Rollback
```bash
sudo apt-get remove -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```
